---
title: "Introduction to genpwr"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to genpwr}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(collapse = T, comment = "#>")
knitr::opts_chunk$set(fig.width=8, fig.height=5) 
options(tibble.print_min = 4L, tibble.print_max = 4L)
library(dplyr)
library(ggplot2)
set.seed(1014)
```

The genpwr package allows the user to perform power calculations for hypothetical genetic association studies using user-specified genetic models, such as additive, dominant, and recessive. The user has the option to specify the "True" genetic model (the actual genetic behavior of the given variant) as well as the "Test" model (the model used for calculating the power).

The genpwr package allows the user to perform calculations from any combination of the following options:

* Logistic or linear outcome variable

* Optional interaction between genetic variant and environmental exposure

* Environmental exposure can be linear or logistic

genpwr is capable of calculating:

* sample size

* effect size (or odds ratio in the case of a logistic outcome variable)

* power

provided that two of the three above variables are entered into the model.

Input variables include:

* Case Rate (or standard deviation in linear outcome models)

 - Can also specify number of controls per case

* Minor Allele Frequency

* Genetic odds ratio (or effect size in the case of linear outcome models)

* Type 1 error rate, or "Alpha"

* "True" model type (recessive, dominant, additive)

* "Test" model type (recessive, dominant, additive, 2 degree of freedom)

Assuming an environmental exposure interaction term is included:

* Population prevalence of environmental exposure

* Environmental exposure odds ratio (or effect size in the case of linear outcome models)

* Environmental exposure / genetic variant interaction term odds ratio (or effect size in the case of linear outcome models)

## Install genpwr 

To install the package, first, you need to install the devtools package. You can do this from CRAN. Invoke R and then type:

```{r, eval=F}
install.packages("devtools")
```

Next, load the devtools package:
```{r}
library(devtools)
```

Install the package.

```{r, eval = F}
install_github("camillemmoore/Power_Genetics", subdir="genpwr")
```

Load the package.

```{r}
library(genpwr)
```

## Examples

* Power Calculation

```{r}
pw <- power.calc(N=400, Case.Rate=0.4, k=NULL,
   MAF=seq(0.05, 0.1, 0.01), OR=c(3),Alpha=0.05,
   True.Model=c("Dominant", "Recessive", "Additive1"), 
   Test.Model=c("Dominant", "Recessive", "Additive", "2df"))
```

We look to see what our resultant data frame looks like:

```{r}
head(pw)
```

We then use the plotting function to plot these results

```{r}
power.plot(pw)
```

### Sample Size Calculation

```{r}
ss <- ss.calc(OR=4, Case.Rate=0.4, k=NULL,
   MAF=seq(0.3, 0.4, 0.02), power=0.8, Alpha=0.05,
   True.Model=c("Dominant", "Recessive", "Additive1"), 
   Test.Model=c("Dominant", "Recessive", "Additive", "2df"))
```

Plot:

```{r}
ss.plot(ss)
```

### Odds Ratio Calculation

```{r}
or <- effect_size_function(N=1000, Case.Rate=0.4, k=NULL,
   MAF=seq(0.30, 0.45, 0.02), power=0.4, Alpha=0.05,
   True.Model="All", Test.Model="All")
```

```{r}
or.plot(or)
```

### Power with logistic environment interaction

```{r}
pec <- power_envir.calc(N=500, Case.Rate=0.3, MAF=seq(0.2,0.4,0.02), OR_G=3, 
                 OR_E=3.5, OR_GE=4, P_e = 0.4, 
                 Alpha=0.05, True.Model='All', Test.Model='All')
```

```{r}
power.plot(pec)
```

### Sample size with logistic environment interaction

```{r}
sse <- ss_envir.calc(power=0.5, Case.Rate=0.4, MAF=seq(0.3,0.4,0.05), OR_G=1.5, 
                 OR_E=1.3, OR_GE=1.2, P_e = 0.4, 
                 Alpha=0.05, True.Model='All', Test.Model='All')
```

```{r}
ss.plot(sse)
```